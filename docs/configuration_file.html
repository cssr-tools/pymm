

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration file &mdash; pymm  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #aaaaaa" >

          
          
          <a href="index.html">
            
              <img src="_static/pymm_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#image-related-parameters">Image-related parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#figure-and-device-related-parameters">Figure- and device-related parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mesh-related-parameters">Mesh-related parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remaining-parameters">Remaining parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">pymm Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_folder.html">Output folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="related.html">Related</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About pymm</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #aaaaaa" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pymm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration file</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/configuration_file.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration-file">
<h1>Configuration file<a class="headerlink" href="#configuration-file" title="Link to this heading"></a></h1>
<p>Let us consider the image below (this image and the real dimensions can be
extracted from Fig. 52 in <a class="reference external" href="https://hdl.handle.net/1956/21300">Benali2019</a> and Fig. 1c
in <a class="reference external" href="https://doi.org/10.1016/j.ijggc.2023.103885">Liu2022</a>.</p>
<figure class="align-default" id="id4">
<img alt="_images/microsystem.png" src="_images/microsystem.png" />
<figcaption>
<p><span class="caption-text">Grains and pore space configuration.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This image (2D) consists of 805x252 pixels, and the real dimensions (3D) are 6.74e-3 x 2.5e-3 x 0.03e-3 [m].
We remark that the image of the pattern used in the numerical simulations in <a class="reference external" href="https://doi.org/10.1016/j.ijggc.2023.103885">Liu2022</a>
has a much higher resolution.</p>
<p>The current implementation allows for the following input parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&quot;&quot;&quot;Set the framework parameters&quot;&quot;&quot;</span>
<span class="linenos"> 2</span><span class="mf">6.74e-3</span>     <span class="c1">#Image-related, length of the microsystem [m]</span>
<span class="linenos"> 3</span><span class="mf">2.5e-3</span>      <span class="c1">#Image-related, height of the microsystem [m]</span>
<span class="linenos"> 4</span><span class="mf">0.03e-3</span>     <span class="c1">#Image-related, depth of the microsystem [m]</span>
<span class="linenos"> 5</span><span class="mi">160</span>         <span class="c1">#Image-related, threshold for converting the image to binary</span>
<span class="linenos"> 6</span><span class="mf">1.0</span>         <span class="c1">#Image-related, rescaled factor for the input image</span>
<span class="linenos"> 7</span><span class="mi">0</span>           <span class="c1">#Image-related, minimum size of the grain clusters</span>
<span class="linenos"> 8</span><span class="mi">0</span>           <span class="c1">#Image-related, tolerance to approximate the border as polygon</span>
<span class="linenos"> 9</span><span class="mi">0</span>           <span class="c1">#Image-related, tolerance to approximate the grains as polygon</span>
<span class="linenos">10</span><span class="mf">1.0</span>         <span class="c1">#Figure-related, line width to show the contours in the produced figures</span>
<span class="linenos">11</span><span class="mf">0.2e-3</span>      <span class="c1">#Device-related, width of the top and bottom channels in the micromodel device [m]</span>
<span class="linenos">12</span><span class="mf">8e-6</span>        <span class="c1">#Mesh-related, mesh size [m]</span>
<span class="linenos">13</span><span class="mf">1e-6</span>        <span class="c1">#Fluid-related, kinematic viscosity [Dynamic viscosity/fluid_density, m2/s]</span>
<span class="linenos">14</span><span class="mf">1e-12</span>       <span class="c1">#Tracer-related, diffusion coefficient [m2/s]</span>
<span class="linenos">15</span><span class="mf">5.0e-4</span>      <span class="c1">#Simulation-related, inlet boundary condition (Pressure/fluid_density, [Pa/(kg/m3)])</span>
<span class="linenos">16</span><span class="mf">120.0</span>       <span class="c1">#Simulation-related, end time for the tracer simulation [s]</span>
<span class="linenos">17</span><span class="mf">1.0</span>         <span class="c1">#Simulation-related, time interval to write the tracer results [s]</span>
<span class="linenos">18</span><span class="mf">1e-7</span>        <span class="c1">#Solver-related, convergence criterium for the pressure solution in the numerical scheme for the Stokes simulation</span>
<span class="linenos">19</span><span class="mf">1e-8</span>        <span class="c1">#Solver-related, convergence criterium for the velocity solution in the numerical scheme for the Stokes simulation</span>
<span class="linenos">20</span><span class="mi">10000</span>       <span class="c1">#Solver-related, maximum number of iterations for the Stokes simulation in case the convergence criteria have not been reached</span>
<span class="linenos">21</span><span class="mf">1.0</span>         <span class="c1">#Solver-related, time step in the numerical scheme for the Tracer simulation [s]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not remove # in each line (in the current implementation this is used for the reading of the parameters).</p>
</div>
<section id="image-related-parameters">
<h2>Image-related parameters<a class="headerlink" href="#image-related-parameters" title="Link to this heading"></a></h2>
<p>The three first parameters set the real dimensions of the microsystem. The next parameter sets the threshold
value to convert the image to binary (valid values from 0 to 255). The rescaled factor parameter reduces the number
of pixels of the image (valid values between 0 and 1, see
<a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.transform.html#skimage.transform.rescale">skimage.transform.rescale</a>.
The minimum size of the grain clusters controls the number of pixels to consider for the internal grains (valid values are
greater than 0, see <a class="reference external" href="https://porespy.org/modules/generated/porespy.filters.trim_small_clusters.html">porespy.filters.trim_small_clusters</a> ).
The two following parameters, for setting the tolerance to approximate the contours of polygons, reduce the number of points in the extracted border
and internal grains respectively (valid values are 0 or greater than 0, see <a class="reference external" href="https://scikit-image.org/docs/stable/auto_examples/edges/plot_polygon.html">skimage.measure.approximate_polygon</a> ).
The following figure shows the internal grains and border for three decreasing values of the minimum size cluster and tolerances.</p>
<figure class="align-default">
<img alt="_images/size_500_5_5.png" src="_images/size_500_5_5.png" />
</figure>
<figure class="align-default">
<img alt="_images/size_100_1_1.png" src="_images/size_100_1_1.png" />
</figure>
<figure class="align-default" id="id5">
<img alt="_images/size_0_0_0.png" src="_images/size_0_0_0.png" />
<figcaption>
<p><span class="caption-text">Extracted contours for minimum size of the cluster grains and tolerances for the polygon approximation of (top) 500, 5, 5, (middle) 100, 1, 1, and (bottom) 0, 0, 0, respectively.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The smaller are these numbers, the more detail is included in the mesh; however, this increases the execution
time to create the mesh and to run the simulations.</p>
</div>
</section>
<section id="figure-and-device-related-parameters">
<h2>Figure- and device-related parameters<a class="headerlink" href="#figure-and-device-related-parameters" title="Link to this heading"></a></h2>
<p>The figure parameter controls the line width of the contours on the output images, while the device parameter controls the
width of the channels in the device microsystem (see the following subsection for details about the implemented device).</p>
</section>
<section id="mesh-related-parameters">
<h2>Mesh-related parameters<a class="headerlink" href="#mesh-related-parameters" title="Link to this heading"></a></h2>
<p>Currently the only input parameter (via de configuration file, one can always modify the template files) for the mesh is
the mesh size. The following figure shows the generated mesh for two different mesh sizes.</p>
<figure class="align-default">
<img alt="_images/mesh_1e4.png" src="_images/mesh_1e4.png" />
</figure>
<figure class="align-default" id="id6">
<img alt="_images/mesh_1e5.png" src="_images/mesh_1e5.png" />
<figcaption>
<p><span class="caption-text">Two different generated meshes of sizes (top) 1e-4 and (bottom) 1e-5.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>There are currently two template files that define the configuration of the microsystem: image.mako and device.mako.
The template image.mako considers that the flow is from top to bottom of the image, while device.mako creates the micromodel geometry as in
<a class="reference external" href="https://hdl.handle.net/1956/21300">Benali2019</a> and <a class="reference external" href="https://doi.org/10.1016/j.ijggc.2023.103885">Liu2022</a>. On the grains and device walls we consider no-slip conditions. Then one could look at those files to modify the values (e.g., the
flow direction or create quad elements for the mesh) or to define new micromodel geometries (e.g., a micromodel with a vertical cross-type shape).
The following figure shows the geometry of the device micromodel.</p>
<figure class="align-default" id="id7">
<img alt="_images/device.png" src="_images/device.png" />
<figcaption>
<p><span class="caption-text">Geometry of the device mode.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="remaining-parameters">
<h2>Remaining parameters<a class="headerlink" href="#remaining-parameters" title="Link to this heading"></a></h2>
<p>The remaining parameters are OpenFOAM related. Refer to the online OpenFOAM resources for details about
the simulator and <a class="reference external" href="https://www.slideshare.net/ElwardiFadli/permeability-of-soils">this nice presentation</a>
using the OpenFOAM solver simpleFoam in another micromodel application. Details about the solver simpleFoam
and mathematical model can be found <a class="reference external" href="https://openfoamwiki.net/index.php/OpenFOAM_guide/The_SIMPLE_algorithm_in_OpenFOAM">in this link</a>.
Details about the solver scalarTransportFoam and mathematical model can be found <a class="reference external" href="https://openfoamwiki.net/index.php/ScalarTransportFoam">here</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NORCE Norwegian Research Centre AS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>